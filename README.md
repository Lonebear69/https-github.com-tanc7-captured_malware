# Captured malware variant

Detected something suspicious when I entered the command netstat -antp. It appears to be connecting back to a Amazon AWS server on listener port 10000

# Forensic analysis

Removed /usr/bin/atd and submitted to VirusTotal, which pointed out that it is a new variant of Patooty.A. Note: I later learned that atd is some sort of startup daemon much like CRON, which is not a default installation in Kali Linux. Also note that whoever installed this only meant to rename the binary atd. It is not the legitimate atd binary, it is a trojan.

Changed file permissions to 400 using chmod (to disarm it) and then used binwalk entropy analysis. The graph shows that the file is about 3x larger than it's usual size and makes heavy use of encoding and obfuscation techniques to hide it's intents.

Noticed that there is something really strange about the code when using objdump -D, it seems to be re-encoded multiple times using XOR exclusive-or. Approximately 30445 lines of it has a XOR Assembly Opcode.

The app appears to have no other purpose than to connect back to the AWS address. p0f flagged the traffic as suspicious.

When observing the strings using IDA decompiler/disassembler, it made several references to a popular alternative Remote Access Trojan called Pupy. As well as debugging strings referring to alternative injection methods if it was a Windows target. Which in this case would be reflective DLL injection.

# Additional notes

Compiled with Red Hat Enterprise Linux, using gcc version 4.7

# Motives behind malware

Given that I am being investigated by the FBI, I believe that the feds reused my choice RAT and gave it a few modifications, and sent it along to me in a non-intrusive surveillance campaign to track down my many IP addresses that I identify myself as online. I kept track of the Intrusion Detection System Alerts source IPs (me) as it contacted back to C2. And saved the unique IP's under doxxedipaddresses.log, which totals 29 unique IP addresses that the feds have successfully linked to me.


I considered this operation non-intrusive as it made NO Kernel modifications or triggered any alerts on my virtual machine. Which usually would point to the sign of tampering with critical runtime processes or process migration/injection attempts. 

shodan.io pointed nothing suspicious about the listener C2 address 54.172.139.247. 
